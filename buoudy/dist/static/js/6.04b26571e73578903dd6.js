webpackJsonp([6],{CRq5:function(t,e){},vNFr:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("Dd8w"),i=s.n(a),n=s("NYxO"),c=s("543z"),l={name:"seats",data:function(){return{cinemaName:"",cinemaId:"",hallId:"",hallName:"",movieName:"",movieId:"",showId:"",buyNumLimit:0,dateShow:"",seatsPrice:{},price:"0",seats:[],rows:0,ticketInfo:{},ticketCount:0}},computed:i()({},Object(n.c)(["hallInfo"])),watch:{$route:function(t,e){"seats"===t.name&&this.initView()}},methods:i()({},Object(n.b)({getHallInfo:"GET_HALL_INFO",openTip:"OPEN_TIP"}),{fetchData:function(){var t=this;this.getHallInfo({}).then(function(){t.cinemaName=t.hallInfo.cinemaName,t.cinemaId=t.hallInfo.cinemaId,t.hallId=t.hallInfo.hallId,t.hallName=t.hallInfo.hallName,t.movieName=t.hallInfo.movieName,t.movieId=t.hallInfo.movieId,t.showId=t.hallInfo.cinemaName,t.buyNumLimit=t.hallInfo.buyNumLimit,t.dateShow=t.hallInfo.dateShow+" "+t.hallInfo.showTime,t.seatsPrice=t.hallInfo.seatsPrice,t.seats=t.hallInfo.section.seats,t.rows=t.hallInfo.section.rows,t.$nextTick(function(){this.initView()})}).catch(function(t){return console.log(t)})},initView:function(){var t=this.$refs.wrapper,e=this.$refs.scroll,s=t.clientWidth,a=e.querySelector(".seat-map").clientWidth;e.style.width=a+"px";var i=e.clientWidth;i>s&&t.scrollTo((i-s)/2,0)},selectSeat:function(){var t=this;this.$refs.seatMap.addEventListener("click",function(e){var s=e.target;if("A"===s.tagName&&"N"===s.dataset.type){if(s.classList.contains("active")){if(t.ticketCount>=t.buyNumLimit)return void t.openTip({message:"一次最多选择"+t.buyNumLimit+"个座位"});s.classList.remove("active"),s.classList.add("selected");var a=s.dataset.row+"排"+s.dataset.column+"座";t.ticketInfo[a]=s,t.ticketCount++}else{s.classList.remove("selected"),s.classList.add("active");a=s.dataset.row+"排"+s.dataset.column+"座";delete t.ticketInfo[a],t.ticketCount--}t.price=0===t.ticketCount?"0":t.seatsPrice[t.ticketCount].price}})},isValidSeat:function(t){var e=t.previousSibling;if(e&&e.classList.contains("active")&&(!(e=e.previousSibling)||!e.classList.contains("active")))return!1;var s=t.nextSibling;return!(s&&s.classList.contains("active")&&(!(s=s.nextSibling)||!s.classList.contains("active")))},commit:function(){var t=this.ticketInfo;for(var e in t)if(!this.isValidSeat(t[e]))return void this.openTip({message:"请重新选择座位，旁边不要留下单个座位"});e&&(c.b.setTitleInfo("createOrder",this.cinemaName),this.$router.push({name:"createOrder",params:{orderId:"111111"}}))}}),created:function(){this.fetchData()},mounted:function(){this.selectSeat()}},o={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{ref:"seats",attrs:{id:"seats"}},[s("div",{staticClass:"movie cf"},[s("button",{ref:"commit",staticClass:"btn btn-pay background-color",on:{click:t.commit}},[t._v("提交订单")]),t._v(" "),s("div",{staticClass:"info"},[s("h3",[t._v(t._s(t.movieName))]),t._v(" "),s("p",[t._v(t._s(t.dateShow))])])]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:0===t.ticketCount,expression:"ticketCount === 0"}],staticClass:"tips cf",attrs:{id:"seatType"}},[t._m(0)]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.ticketCount>0,expression:"ticketCount > 0"}],staticClass:"tips cf",staticStyle:{display:"none","transform-origin":"0px 0px 0px",opacity:"1",transform:"scale(1, 1)"},attrs:{id:"selectSeat"}},[s("em",{staticClass:"theme-color"},[t._v(t._s(t.price))]),t._v(" "),s("ul",{staticClass:"seat-list"},t._l(t.ticketInfo,function(e,a){return s("li",{key:e},[t._v(t._s(a))])}),0)]),t._v(" "),s("div",{staticClass:"main"},[s("h3",[t._v(t._s(t.hallName))]),t._v(" "),s("div",{ref:"wrapper",staticClass:"wrapper"},[s("div",{ref:"scroll",staticClass:"scroll"},[t._m(1),t._v(" "),s("div",{staticClass:"center-line"}),t._v(" "),s("div",{ref:"seatMap",staticClass:"seat-map"},t._l(t.seats,function(e,a){return s("p",{key:e},[t._l(e.columns,function(e){return["N"===e.st?s("a",{key:e.st,staticClass:"seat active",attrs:{"data-type":e.st,"data-row":a+1,"data-column":e.columnId,"data-num":e.seatNo}}):"LK"===e.st?s("a",{key:e.st,staticClass:"seat disabled",attrs:{"data-type":e.st,"data-row":a+1,"data-column":e.columnId,"data-num":e.seatNo}}):t._e()]})],2)}),0)])]),t._v(" "),s("div",{staticClass:"side"},[s("ol",[s("li",{staticClass:"cs"}),t._v(" "),t._l(t.rows,function(e){return s("li",{key:e},[t._v(t._s(e))])}),t._v(" "),s("li",{staticClass:"cs"})],2)])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("ul",{staticClass:"seat-intro"},[e("li",[e("span",{staticClass:"seat active"}),this._v("可选")]),this._v(" "),e("li",[e("span",{staticClass:"seat selected"}),this._v("已选")]),this._v(" "),e("li",[e("span",{staticClass:"seat disabled"}),this._v("已售")]),this._v(" "),e("li",[e("span",{staticClass:"seat love"}),this._v("情侣座")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"c-tips"},[e("span",[this._v("银幕中央")])])}]};var r=s("VU/8")(l,o,!1,function(t){s("CRq5")},"data-v-dda097ac",null);e.default=r.exports}});
//# sourceMappingURL=6.04b26571e73578903dd6.js.map